# 本のバーコードスキャナー 開発計画

## 1. プロジェクト概要

本のバーコード（ISBN）をスキャンして書籍情報と中古価格を取得・管理するWebアプリケーション

### 開発条件
- 可読性を重視
- シンプルな構成
- テスト自動化
- Dockerは使わない
- GitHub Actionsは使わない

## 2. プロジェクト構成（シンプル重視）

```
book-barcode-scanner/
├── frontend/
│   ├── index.html
│   ├── css/
│   │   └── style.css
│   ├── js/
│   │   ├── app.js
│   │   ├── scanner.js
│   │   ├── bookApi.js
│   │   └── export.js
│   └── tests/
│       └── unit/
├── backend/
│   ├── main.py
│   ├── api/
│   │   └── amazon.py
│   ├── tests/
│   │   └── test_api.py
│   ├── requirements.txt
│   └── venv/  # 仮想環境
├── .env.example
├── .gitignore
├── package.json  # フロントエンド依存関係
├── README.md
├── Makefile  # タスク自動化
└── tests/
    └── e2e/
```

## 3. 技術選定

### フロントエンド
- **Vanilla JavaScript** + **ES6 Modules** - フレームワーク依存なし、可読性重視
- **ZXing-js** - バーコードスキャン
- **Jest** (Node.js) - ユニットテスト
- **Playwright** - E2Eテスト
- **npm scripts** - タスク実行

### バックエンド  
- **FastAPI** + **Uvicorn** - 自動ドキュメント生成、型安全性
- **Python venv** - 仮想環境管理
- **Pydantic** - バリデーション、可読性向上
- **pytest** - テスト
- **httpx** - 非同期HTTP通信

### 開発ツール
- **npm** - フロントエンド依存関係管理
- **ESLint + Prettier** - JavaScript品質
- **Black + isort + flake8** - Python品質
- **Makefile** - タスク自動化
- **pre-commit** - ローカル品質チェック

## 4. 環境セットアップ

### 初期セットアップスクリプト
```bash
# setup.sh
#!/bin/bash
echo "Setting up Book Barcode Scanner..."

# Python環境
cd backend
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# JavaScript環境
cd ../frontend
npm install

# 開発ツール
pip install pre-commit black isort flake8
pre-commit install
```

## 5. 開発フェーズ詳細

### Phase 1: 基盤構築 (1-2週間)
- [x] プロジェクト初期設定
- [ ] 開発環境セットアップスクリプト
- [ ] バーコードスキャン機能
- [ ] Google Books API連携
- [ ] 基本UI（レスポンシブ）
- [ ] ユニットテスト設定

### Phase 2: バックエンド開発 (1-2週間)
- [ ] FastAPIサーバー構築
- [ ] Python仮想環境セットアップ
- [ ] Amazon価格取得API
- [ ] API仕様書自動生成
- [ ] エラーハンドリング
- [ ] バックエンドテスト

### Phase 3: 統合・完成 (1週間)
- [ ] フロント・バック統合
- [ ] エクスポート機能
- [ ] E2Eテスト
- [ ] パフォーマンス最適化
- [ ] 手動デプロイ手順書

## 6. テスト戦略（手動実行）

### 自動化レベル
1. **ユニットテスト**: 各関数・コンポーネント
2. **統合テスト**: API間連携
3. **E2Eテスト**: ユーザーシナリオ
4. **Visual Regression**: UI変更検知

### テストカバレッジ目標
- **フロントエンド**: 80%以上
- **バックエンド**: 90%以上  
- **E2E**: 主要フロー100%

### テスト実行コマンド（Makefile定義）
```bash
test-frontend:
    cd frontend && npm test

test-backend:
    cd backend && source venv/bin/activate && pytest

test-e2e:
    npx playwright test

test-all: test-frontend test-backend test-e2e

lint:
    cd frontend && npm run lint
    cd backend && source venv/bin/activate && black . && isort . && flake8
```

## 7. 品質保証（ローカルベース）

### 開発時チェック
- **pre-commit hooks** - コミット前自動チェック
- **npm scripts** - フロントエンド品質チェック
- **Makefile** - 統一されたタスク実行

### 手動チェックリスト
```markdown
- [ ] ユニットテスト全件通過
- [ ] E2Eテスト主要シナリオ通過
- [ ] コードフォーマット適用済み
- [ ] セキュリティチェック実施
- [ ] パフォーマンステスト実施
```

### 監視・ロギング
- **構造化ログ** (JSON形式)
- **エラートラッキング** 
- **パフォーマンス監視**

## 8. 開発ワークフロー

```
開発 → ローカルテスト → コードレビュー → マージ → 手動デプロイ
```

### ブランチ戦略
- `main` - 安定版
- `develop` - 開発統合  
- `feature/*` - 機能開発
- `hotfix/*` - 緊急修正

### デプロイ手順
1. 手動テスト実行
2. ビルド確認
3. 本番環境への手動アップロード

## 9. 主要機能仕様

### 2.1 バーコードスキャン機能
- **機能**: デバイスのカメラを使用してISBNバーコードをスキャン
- **技術**: WebカメラAPI + ZXing-js ライブラリ
- **対象**: ISBN-10, ISBN-13に対応

### 2.2 書籍情報取得機能
- **機能**: スキャンしたISBNから書籍情報を自動取得
- **取得情報**: タイトル、著者名、定価（税込み）、出版社、出版日
- **API**: Google Books API（無料）

### 2.3 Amazon中古価格取得機能
- **機能**: Amazon上の中古価格を取得
- **実装**: サーバーサイドAPI経由で取得
- **価格情報**: 最安値の中古価格

### 2.4 書籍リスト表示機能
- **機能**: スキャンした書籍を一覧表示
- **表示項目**: 書籍画像、タイトル、著者名、定価、Amazon中古価格、価格差
- **操作**: 個別削除機能

### 2.5 データエクスポート機能
- **機能**: 書籍リストをファイル形式でダウンロード
- **対応形式**: Excel (.xlsx)、CSV (.csv)
- **エクスポート項目**: 表示されている全項目

## 10. セキュリティ要件
- HTTPS必須（カメラアクセスのため）
- CORS設定によるセキュアな通信
- 個人情報の保存なし（セッションベース）
- APIキー等の機密情報は環境変数で管理
- .gitignoreでシークレット情報を除外

## 11. 成功基準
- バーコードスキャン精度 95%以上
- 書籍情報取得成功率 90%以上
- レスポンス時間 3秒以内
- モバイル対応完全サポート